<!DOCTYPE html>
<html>
  <head>
    <title>Introduction to OAuth 2.0 and OpenID Connect</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body {
        font-family: 'Droid Serif';
      }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }

      table, th, td {
        border: 1px solid black;
      }
      th, td {
        padding: 5px;
        text-align: left;
      }
      td {
        padding-left: 5px;
        padding-right: 5px;
      }
      .remark-code { font-family: 'Ubuntu Mono'; }
      .remark-inline-code {
        font-family: 'Ubuntu Mono';
        padding: 2px 4px;
        font-size: 90%;
        color: #c7254e;
        background-color: #f9f2f4;
        border-radius: 0;
       }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# Introduction to OAuth 2.0<br>and OpenID Connect

<img src="images/oauth.png" alt="oauth logo" style="max-width:20%">

<div>
  <small>Presented By<br><a href="https://mherman.org">Michael Herman</a><br><a href="https://twitter.com/mikeherman">@mikeherman</a> </span>
</div>

---

### Day 1

--

##### (1) Intro (~ 10 minutes)

- About Me
- Objectives

--

##### (2) Theory (~ 2 hours)

- Authentication vs Authorization
- OAuth
    - What is OAuth?
    - Terminology
    - Grant types
    - Authorization Code flow
    - History of OAuth

--

##### (3) Practice (~ 5 hours)

- Developing an OAuth 2.0 Server with Node

---

### Day 2

--

##### (1) Theory (~ 1 hour)


- Day 1 Review
- OpenID Connect
    - What is OpenID Connect?
    - How does OpenID work with OAuth 2.0?
    - JSON Web Tokens (JWT)

--

##### (2) Practice (~ 5 hours)

- Adding OpenID Connect to the Node Server
- Developing a Client-side Consumer

--

##### (3) Theory (~ 1 hour)

- Final Review
- Next Steps

---

class: center, middle

## Intro

---

### About Michael

```
$ whoami
michael.herman
```

<p style="margin:0"><img src="images/me.png" style="max-width: 10%;" alt="me"></p>

--

#### Senior Software Engineer from Denver, CO

1. Full-stack + DevOps Contractor
1. [TestDriven.io](https://testdriven.io)

<a href="https://testdriven.io">
  <img src="images/mobile_image.png" style="max-width: 15%; padding-top:5px; box-shadow: none;" alt="testdriven.io">
</a>

--

#### Also

1. Founder and Organizer of [Denver Node.js Meetup Group](https://www.meetup.com/Node-js-Denver-Boulder/)
1. Former Lead Instructor at [Galvanize](https://www.galvanize.com/)
1. Co-founder/author of [Real Python](https://realpython.com)
1. üòç - [tech writing/education](http://mherman.org), [open source](http://github.com/mjhea0), [financial models](http://www.starterfinancialmodel.com/), [radiohead](http://radiohead.com/)

---

### Objectives

--

By the end of this training, you will be able to:

--

1. Describe the difference between authentication and authorization

--

1. Explain what OAuth 2.0 is and how it differs from OAuth 1.0

--

1. Describe the various OAuth 2.0 grant types and when it's appropriate to use each

--

1. Implement an OAuth 2.0 server with Node

--

1. Explain what OpenID is and how it works with OAuth

--

1. Implement OpenID with Node

--

1. Develop a client-side consumer app to interact with an OAuth 2.0 and OpenID server

---

class: center, middle

## Theory

---

### Authentication vs Authorization

--

*"Who are you and what are you allowed to do?"*

--

#### Authentication

- Verifying that someone is who they claim to be.
- *Who are you?*

--

#### Authorization

- Verifying which resources a user can access and what they are allowed to do with those resources.
- *What are you allowed to do?*

--

#### Single Sign-On (SSO)

- Allows a user to enter one set of credentials in order to access multiple applications.

<img src="images/sign_up_with_google.png" style="max-width:30%;padding-top:20px;padding-left:30px;" alt="sign up with google">

---

### What is OAuth?

--

[Oauth](http://oauth.net) is an open standard for authorization.

*"An open protocol to allow secure authorization in a simple and standard method from web, mobile and desktop applications."*

--

It's all about delegation:

--

1. The *Client* application accesses resources, from a *Resource Server*, on behalf of the *User*.
1. The *User* does not have to share their credentials with the *Client*.

--

<br>

**Compared to OAuth 1.0, Oauth 2.0:**

- Is slightly simpler to implement
- Adds time to live (TTL) to the Access Tokens
- Supports mobile and desktop apps
- No longer requires client applications to have cryptography

---

### Terminology

--

| Term                 | Definition                                                                                                                      |
|----------------------|---------------------------------------------------------------------------------------------------------------------------------|
| Resource Owner (aka User) | End user who authorizes an application to access their account                                                             |
| Client (aka Consumer)     | Application that accesses protected resources on behalf of the user                                                        |
| Authorization Server | Server which grants Access Tokens after the user authorizes the application                                                     |
| Resource Server      | Restricted resource / API                                                                                                       |
| Access Token         | Token used to access restricted resources                                                                                       |
| Authorization Code   | Intermediate token returned to the client, after the user authorization step, which the client exchanges it for an access token |
| Grant                | Method of acquiring an access token                                                                                             |

---

### Grant Types

--

| Grant Type                 | Use Case                    | Link                                                           |
|----------------------------|-----------------------------|----------------------------------------------------------------|
| Authorization Code         | Server-side web apps        | [section 4.1](https://tools.ietf.org/html/rfc6749#section-4.1) |
| Implicit                   | Single Page Apps (SPAs)     | [section 4.2](https://tools.ietf.org/html/rfc6749#section-4.2) |
| Resource Owner Credentials | Trusted first party clients | [section 4.3](https://tools.ietf.org/html/rfc6749#section-4.3) |
| Client Credentials         | Machine-to-machine          | [section 4.4](https://tools.ietf.org/html/rfc6749#section-4.4) |

--

#### Questions

--

- **Which grant should you use?** [Decision tree](images/oauth-grants.svg)

--

- **First vs third party client?**

    - First party clients are clients that you trust. For example, Twitter *probably* trusts the Twitter iPhone app since they own it.
    - Third party clients are clients that you don't trust.

--

- **Access Token Owner?** Do you not need the user's permission to access the restricted resources?


--

<small>Source: <a href="https://alexbilbie.com/guide-to-oauth-2-grants/">A Guide to OAuth 2.0 Grants</a></small>

---

### Authorization Code Flow

--

<br>

**[Step 1]** *Client* redirects the *Resource Owner* to the *Authorization Server*

<img src="images/oauth-flow-step1.png" style="padding-left:30px;" alt="oauth flow step 1">

--

<br>

**[Step 2]** *Resource Owner* grants authorization

**[Step 3]** *Authorization Server* redirects the *Resource Owner* back to the *Client* with an *Authorization Code*

<img src="images/oauth-flow-step2-step3.png" style="padding-left:30px;" alt="oauth flow step 2 and 3">

---

### Authorization Code Flow (continued...)

--

**[Step 4]** *Client* exchanges *Authorization Code* for *Access Token*

<img src="images/oauth-flow-step4.png" style="padding-left:30px;" alt="oauth flow step 4">

--

<br>

**[Step 5]** *Authorization Server* grants *Access Token*

<img src="images/oauth-flow-step5.png" style="padding-left:30px;" alt="oauth flow step 5">

---

### Authorization Code Flow (continued...)

--

<br>

**[Step 6]** *Client* uses the *Access Token* to access protected resources, from the *Resource Server*, on behalf of the *Resource Owner*

<img src="images/oauth-flow.png" style="padding-left:30px;" alt="oauth flow">

--

<br>

What's different about this flow for the other grant types&mdash;Implicit, Resource Owner Credentials, Client Credentials?

---

### History of OAuth

--

#### Before OAuth

--

The User would provide their credentials directly to the Client app.

--

##### Problems

1. Client stores User's password (one more application with your password)
1. Client gets complete access to the User's account (scope)
1. User cannot revoke access to the Client unless they reset their password

--

#### [Oauth 1.0](https://oauth.net/core/1.0/)

--

Introduced in December 2017 to prevent the Client application from having to directly handle the User's credentials.

--

##### Problems

1. Difficult to implement
1. Complex cryptographic requirements
1. Poor support for native desktop and mobile apps

---

### History of OAuth (continued...)

--

#### [Oauth 2.0](https://oauth.net/2/)

First came out in April 2010.

--

##### Problems

1. Still difficult to implement
1. Difficult for the User to update the scope
1. Security concerns

--

<br>

##### Recommended reads

- [OAuth 2.0 and the Road to Hell](https://hueniverse.com/oauth-2-0-and-the-road-to-hell-8eec45921529)
- [OAuth 2 Simplified](https://aaronparecki.com/oauth-2-simplified/)
- [Introducing TAuth: Why OAuth 2.0 is bad for banking APIs and how we're fixing it](https://blog.teller.io/2016/04/26/tauth.html)

---

### Check for Understanding

--

- What's the difference between authentication and authorization?

--

- What is OAuth?

--

- Describe the various OAuth 2.0 grant types?

--

- How does the grant type affect the OAuth 2.0 authorization flow?

<br>
<br>

ü§î

---

class: center, middle

## Practice

---

### What are we Building?

---

class: center, middle

## Theory

---

### Day 1 Review

---

### What is OpenID Connect?

---

### How does OpenID work with OAuth 2.0?

---

### JSON Web Tokens (JWT)

---

class: center, middle

## Practice

---

### Adding OpenID

---

### Client-side Consumer

---

class: center, middle

## Theory

---

### Final Review

---

### Next Steps

--

##### Additional Resources

1. [Authentication and Authorization: OpenID vs OAuth2 vs SAML](https://spin.atomicobject.com/2016/05/30/openid-oauth-saml/)
1. Resource two

--

##### Contact Info

1. [michael@mherman.org](mailto:michael@mherman.org)
1. [mherman.org](https://mherman.org)
1. [@mikeherman](https://twitter.com/mikeherman)

--

##### Final Questions?

‚úåÔ∏è


    </textarea>
    <script src="./remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({countIncrementalSlides: false});
    </script>
  </body>
</html>
